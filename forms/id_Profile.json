{
    "className": "org.joget.apps.form.model.Form",
    "elements": [{
        "className": "org.joget.apps.form.model.Section",
        "elements": [{
            "className": "org.joget.apps.form.model.Column",
            "elements": [
                {
                    "className": "org.joget.apps.form.lib.FileUpload",
                    "properties": {
                        "attachment": "",
                        "fileType": "",
                        "fileTypeMsg": "Invalid file type",
                        "id": "idPhotot",
                        "label": "Photo :",
                        "maxSize": "",
                        "maxSizeMsg": "File size limit exceeded",
                        "multiple": "",
                        "padding": "",
                        "permissionType": "",
                        "readonly": "",
                        "removeFile": "",
                        "resizeHeight": "",
                        "resizeMethod": "",
                        "resizeQuality": "0.8",
                        "resizeWidth": "",
                        "size": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        }
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.TextField",
                    "properties": {
                        "id": "idNom",
                        "label": "Nom :",
                        "maxlength": "",
                        "permissionHidden": "",
                        "placeholder": "",
                        "readonly": "true",
                        "readonlyLabel": "",
                        "size": "",
                        "storeNumeric": "",
                        "style": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "#currentUser.firstName#",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.TextField",
                    "properties": {
                        "id": "idPrenom",
                        "label": "Prenom :",
                        "maxlength": "",
                        "permissionHidden": "",
                        "placeholder": "",
                        "readonly": "true",
                        "readonlyLabel": "",
                        "size": "",
                        "storeNumeric": "",
                        "style": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "#currentUser.lastName#",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.TextField",
                    "properties": {
                        "id": "idEmail",
                        "label": "E-mail :",
                        "maxlength": "",
                        "permissionHidden": "",
                        "placeholder": "",
                        "readonly": "true",
                        "readonlyLabel": "",
                        "size": "",
                        "storeNumeric": "",
                        "style": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "#currentUser.email#",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.TextArea",
                    "properties": {
                        "cols": "20",
                        "id": "idDescription",
                        "label": "Description de profil :",
                        "placeholder": "",
                        "readonly": "",
                        "readonlyLabel": "",
                        "rows": "5",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.HiddenField",
                    "properties": {
                        "id": "idFKuser",
                        "useDefaultWhenEmpty": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "#currentUser.username#",
                        "workflowVariable": ""
                    }
                },
                {
                    "className": "org.joget.apps.form.lib.HiddenField",
                    "properties": {
                        "id": "idGenerExperience",
                        "useDefaultWhenEmpty": "",
                        "validator": {
                            "className": "",
                            "properties": {}
                        },
                        "value": "",
                        "workflowVariable": ""
                    }
                }
            ],
            "properties": {"width": "100%"}
        }],
        "properties": {
            "comment": "",
            "id": "id_info",
            "join": "",
            "label": "Informations personnelles",
            "loadBinder": {
                "className": "org.joget.apps.form.lib.BeanShellFormBinder",
                "properties": {
                    "autoHandleFiles": "",
                    "autoHandleWorkflowVariable": "true",
                    "cacheInterval": "",
                    "script": "import java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport javax.sql.DataSource;\nimport org.joget.apps.app.service.AppUtil;\nimport org.joget.apps.form.model.Form;\nimport org.joget.apps.form.model.Element;\nimport org.joget.apps.form.model.FormData;\nimport org.joget.apps.form.model.FormRow;\nimport org.joget.apps.form.model.FormRowSet;\nimport org.joget.apps.form.service.FormUtil;\nimport org.joget.commons.util.UuidGenerator;\n \nFormRowSet f = new FormRowSet();\nf.setMultiRow(true);\n \n\nDataSource ds = (DataSource) AppUtil.getApplicationContext().getBean(\"setupDataSource\");\n \ncon = ds.getConnection();\n \nif (!con.isClosed()) {\n    \n    //String jib_id = \"#requestParam.id#\";\n    String fk = \"#currentUser.username#\";\n   \n    String x = \"select id,c_idPhotot,c_idDescription from app_fd_info_personnel where c_idFKuser=?\";\n    PreparedStatement stmt = con.prepareStatement(x);\n    stmt.setString(1, fk);\n  \n    \n    ResultSet rs = stmt.executeQuery();\n         \n   \n    while (rs.next()) {\n        FormRow r1 = new FormRow();\n        r1.put(\"idGenerExperience\", rs.getString(1));\n        r1.put(\"idPhotot\", rs.getString(2));\n        r1.put(\"idDescription\", rs.getString(3));\n        f.add(r1);\n    }\n}\n \nreturn f;"
                }
            },
            "permission": {
                "className": "",
                "properties": {}
            },
            "permissionReadonly": "",
            "readonly": "",
            "readonlyLabel": "",
            "regex": "",
            "reverse": "",
            "storeBinder": {
                "className": "org.joget.apps.form.lib.BeanShellFormBinder",
                "properties": {
                    "autoHandleFiles": "",
                    "autoHandleWorkflowVariable": "true",
                    "cacheInterval": "",
                    "script": "import java.sql.Connection;\nimport java.sql.PreparedStatement;\nimport java.sql.ResultSet;\nimport java.sql.SQLException;\nimport javax.sql.DataSource;\nimport org.joget.apps.app.service.AppUtil;\nimport org.joget.apps.form.model.Form;\nimport org.joget.apps.form.model.Element;\nimport org.joget.apps.form.model.FormData;\nimport org.joget.apps.form.model.FormRow;\nimport org.joget.apps.form.model.FormRowSet;\nimport org.joget.apps.form.service.FormUtil;\nimport org.joget.commons.util.UuidGenerator;\n \npublic saveInfoPer(Element element, FormRowSet rows, FormData formData) {\n     \n    Connection con = null;\n     \n    try {\n       \n        DataSource ds = (DataSource) AppUtil.getApplicationContext().getBean(\"setupDataSource\");\n \n        con = ds.getConnection();\n         \n        if(!con.isClosed()) {\n          \n            UuidGenerator uuid = UuidGenerator.getInstance();\n             \n\n             \n            Iterator i= rows.iterator();\n            while (i.hasNext()) {\n                FormRow row = (FormRow) i.next();\n                String pId = uuid.getUuid();\n                String column1 = row.get(\"idPhotot\");\n                String column2 = row.get(\"idNom\");\n                String column3 = row.get(\"idPrenom\");\n                String column4 = row.get(\"idEmail\");\n                String column5 = row.get(\"idDescription\");\n                String column6 = row.get(\"idFKuser\");\n                String column7 = row.get(\"idGenerExperience\");\n\n                String x= \"SELECT * FROM app_fd_info_personnel WHERE id=?\";\n                PreparedStatement stmt = con.prepareStatement(x);\n                stmt.setString(1, column7);\n                ResultSet rs = stmt.executeQuery();\n      \n                Boolean isExist = false;\n                if (rs.next()) {\n                    isExist = true;\n                }\n                \n                if (isExist) {\n                    String  updateSql = \"UPDATE app_fd_info_personnel SET c_idPhotot = ?, c_idNom = ?, c_idPrenom = ?, c_idEmail = ?, c_idDescription = ?  WHERE id = ?\";\n                    PreparedStatement stmtUPDATE = con.prepareStatement(updateSql);\n\n                    stmtUPDATE.setString(1, column1);\n                    stmtUPDATE.setString(2, column2);\n                    stmtUPDATE.setString(3, column3);\n                    stmtUPDATE.setString(4, column4);\n                    stmtUPDATE.setString(5, column5);\n                    stmtUPDATE.setString(6, column7);\n                \n                    stmtUPDATE.executeUpdate();\n                }else{\n                    \n                String insertSql = \"INSERT INTO app_fd_info_personnel (id,c_idPhotot,c_idNom,c_idPrenom,c_idEmail,c_idDescription,c_idFKuser) VALUES (?,?,?,?,?,?,?);\";\n                PreparedStatement stmtInsert = con.prepareStatement(insertSql);\n                 \n                stmtInsert.setString(1, pId);\n                stmtInsert.setString(2, column1);\n                stmtInsert.setString(3, column2);\n                stmtInsert.setString(4, column3);\n                stmtInsert.setString(5, column4);\n                stmtInsert.setString(6, column5);\n                stmtInsert.setString(7, column6);\n               \n                stmtInsert.executeUpdate();\n                \n                    }\n            }\n        }\n    } catch (Exception ex) {\n        LogUtil.error(\"Your App/Plugin Name\", ex, \"Error storing using jdbc\");\n    } finally {\n        try {\n            if (con != null) {\n                con.close();\n            }\n        } catch (Exception ex) {\n            LogUtil.error(\"Your App/Plugin Name\", ex, \"Error closing the jdbc connection\");\n        }\n    }\n}\n\nsaveInfoPer(element, rows, formData);\n"
                }
            },
            "visibilityControl": "",
            "visibilityValue": ""
        }
    }],
    "properties": {
        "description": "",
        "id": "id_Profile",
        "loadBinder": {
            "className": "org.joget.apps.form.lib.WorkflowFormBinder",
            "properties": {}
        },
        "name": "profile",
        "noPermissionMessage": "",
        "permission": {
            "className": "",
            "properties": {}
        },
        "postProcessor": {
            "className": "",
            "properties": {}
        },
        "postProcessorRunOn": "create",
        "storeBinder": {
            "className": "org.joget.apps.form.lib.WorkflowFormBinder",
            "properties": {}
        },
        "tableName": "Profile"
    }
}